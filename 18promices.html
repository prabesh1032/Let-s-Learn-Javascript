<!-- promices in javascript -->
 <!DOCTYPE html>
 <html lang="en">
 <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
 </head>
 <body style="background-color: lightseagreen;">
    <div>
        <h1 style="text-align: center; margin-top: 50px;">
            Fetch API and Promises
        </h1>
        <div id="first"></div>
    </div>
    <script>
        console.log("Fetching data from GitHub API...");
        const p1 = fetch('https://api.github.com/users')
        //console.log(p1); // Promise { <pending> } it means the promise is still pending 
        //promise is in simple word a object that have 3 stages : pending, fulfilled, rejected
        //first stage is pending when the promise is created but not yet resolved or rejected
        //second stage is fulfilled when the promise is resolved successfully
        //third stage is rejected when the promise is failed to resolve
        //also promices is only in rejected when there is a network error or the request is blocked otherwise it will be fulfilled even if the response status is 404 or 500
        //also we can only read the variable once the promise is fulfilled or rejected

        const p2 = p1.then((response)=>{
            //console.log(response); //here we get the response object but in byte format
            //to convert the response object to json format we use response.json() method
            return response.json(); 
        })
        p2.then((data)=>{
            console.log("Data fetched successfully:");
            console.log(data); //here we get the data in json format
        }).catch((error)=>{
            console.log("Error fetching data:");
            console.log(error); //here we get the error if any
        });
        console.log("Data fetch initiated...");
        //this is the method to read json data using fetch api and promises in javascript 
        
        //in short form we can write the above code as
        fetch('https://api.github.com/users')
        .then((response) => response.json())
        .then((data) => {
            console.log("Data fetched successfully (short form):");
            //console.log(data);
            const firstDiv = document.getElementById('first');
            for(let i= 0; i < data.length; i++) {
                const image = document.createElement('img');
                image.src = data[i].avatar_url;
                image.style.width = '100px';
                image.style.margin = '10px';
                firstDiv.append(image);
            }
        })
        .catch((error) => {
            console.log("Error fetching data (short form):");
            console.log(error);
        });
        //this is called promise chaining
        
        

        //create a promise using the Promise constructor
        const myPromise = new Promise((resolve, reject) => {
            const success = false; //change this to true to see the resolve case
            if(success){
                resolve("Promise resolved successfully!");
            } else {
                reject("Promise rejected!");
            }
            myPromise.then((message) => {
                console.log(message);
            }).catch((error) => {
                console.log(error);
            });

        });

        
    </script>
 </body>
 </html>